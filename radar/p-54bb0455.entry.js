import{r as t,c as e,h as i,g as r,H as a}from"./p-d703c309.js";import{U as o}from"./p-82285f77.js";import{c as s}from"./p-b090f4cf.js";import{_ as l,r as c}from"./p-ae8fd155.js";import{g as n,a as d}from"./p-a8ccf5d0.js";import{d as h,s as p,c as m}from"./p-6343e8b1.js";let u=class{constructor(i){t(this,i),this.onFilesSubmitted=e(this,"onFilesSubmitted",7),this.allowedTypes=["image/*"],this.highlighted=!1,this.handleDrop=t=>{this.handleFiles(t.dataTransfer.files)},this.handleFiles=t=>{t=[...t],console.log("Handle Files",t),this.onFilesSubmitted.emit(t)}}componentDidLoad(){["dragenter","dragover","dragleave","drop"].forEach((t=>{this.dropArea.addEventListener(t,this.preventDefaults,!1),document.body.addEventListener(t,this.preventDefaults,!1)})),["dragenter","dragover"].forEach((t=>{this.dropArea.addEventListener(t,(()=>this.highlighted=!0),!1)})),["dragleave","drop"].forEach((t=>{this.dropArea.addEventListener(t,(()=>this.highlighted=!1),!1)})),this.dropArea.addEventListener("drop",this.handleDrop,!1)}preventDefaults(t){t.preventDefault(),t.stopPropagation()}render(){return i("div",{id:"drop-area"},i("form",{class:{highlight:this.highlighted}},i("h3",null,"Drag Files to Upload"),i("p",null,"Maximum Size: 200 gb "),i("p",null,"Supported types: Spreadsheet CSV, Excel, Shapefile, GeoJSON, PDF, Word Doc, Images"),i("input",{type:"file",id:"fileElem",multiple:!0,accept:this.allowedTypes.join(","),onChange:t=>this.handleFiles(t.target.files)}),i("label",{class:"button retry",htmlFor:"fileElem"},"Browse")))}get dropArea(){return r(this)}};u.style=':host{display:block;box-sizing:border-box;font-family:"Avenir Next W01", "Avenir Next W00", "Avenir Next", "Avenir", "Helvetica Neue", sans-serif;width:90%}#drop-area form{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;width:100%;height:100%;padding:50px 0px;margin:0px;align-items:baseline;padding-left:50px;border:2px dashed lightgray;border-radius:4px;overflow:scroll;background-color:#DDD}#drop-area form p{margin:0px;color:#333}#drop-area form.highlight{border:2px solid green;background:rgba(0, 128, 0, 0.1)}#drop-area form #fileElem{display:none}#drop-area .retry{color:white;background-color:#007ac2;font-size:15px;height:30px;margin-top:20px;padding:8px 18px 0px 18px;cursor:pointer}#drop-area .retry:hover{background-color:#0069b1}@media (min-width: 768px) and (max-width: 991.98px){#drop-area #gallery{grid-template-columns:calc(50% - 1.5ch) calc(50% - 1.5ch)}}@media (min-width: 992px) and (max-width: 1199.98px){#drop-area #gallery{grid-template-columns:calc(33.33% - 2ch) calc(33.33% - 2ch) calc(33.33% - 2ch)}}@media (min-width: 1200px){#drop-area #gallery{grid-template-columns:calc(25% - 2.28ch) calc(25% - 2.28ch) calc(25% - 2.28ch) calc(25% - 2.28ch)}}';let g=class{constructor(e){t(this,e),this.clientid="WXC842NRBVB6NZ2r",this.portal="https://www.arcgis.com",this.editors=[]}componentDidLoad(){const t=o.deserialize(this.session);this.uploadItem(t)}uploadItem(t){s({item:{title:this.file.name,type:this.itemType},file:this.file,overwrite:!1,multipart:!0,async:!0,filename:this.file.name,authentication:t}).then((e=>{var i,r;console.log("Created Item",e),(i={id:e.id,file:this.file,partNum:1,authentication:t},r=i.partNum,!Number.isInteger(r)||r<1||r>1e4?Promise.reject(new Error("The part number must be an integer between 1 to 10000, inclusive.")):h(i).then((function(t){var e=n(i)+"/content/users/"+t+"/items/"+i.id+"/addPart?partNum="+r,a=d(i,["file"],{params:l({},i.params)});return c(e,a)}))).then((i=>{console.log("addItemPart",i),function(t){return h(t).then((function(e){var i=n(t)+"/content/users/"+e+"/items/"+t.id+"/commit",r=d(t,[],{params:l(l({},t.params),p(t.item))});return c(i,r)}))}({item:{title:this.file.name,type:this.itemType},id:e.id,authentication:t,params:{title:this.file.name,type:this.itemType}}).then((t=>{console.log("commitItemUpload",t),this.checkStatus(t.id)}))}))})).catch((t=>{console.error("uploadItem error",t),this.showError(t.message)}))}showError(t){this.editors=[i("calcite-notice",{color:"red",width:"full",scale:"s",active:!0},i("div",{slot:"notice-title"},"Upload Error: ",this.file.name),i("div",{slot:"notice-message"},t))]}checkStatus(t){const e=o.deserialize(this.session);m({id:t,authentication:e}).then((e=>{console.log("Check Status",e),"completed"==e.status?this.editItem(t):setTimeout((()=>{this.checkStatus(t)}),1e3)}))}editItem(t){this.editors=[i("hub-metadata-editor",{item:t})]}render(){return i(a,null,i("slot",null),0==this.editors.length?i("calcite-loader",{label:"label",text:"Fetching data...","is-active":!0}):this.editors)}};g.style=":host{display:block}";export{u as drop_area,g as hub_upload_file}