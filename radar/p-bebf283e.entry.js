import{r as t,h as s,H as e}from"./p-d703c309.js";import{a}from"./p-834ef0aa.js";import{g as r}from"./p-0a3373ac.js";import{U as l}from"./p-82285f77.js";import"./p-8dae81d7.js";import"./p-6343e8b1.js";import"./p-ae8fd155.js";import"./p-a8ccf5d0.js";import"./p-6bdf64e1.js";import"./p-46d9ff3a.js";import"./p-90bbd14a.js";import"./p-797f9b51.js";let i=class{constructor(s){t(this,s),this.site="opendata.victoria.ca",this.query="*",this.limit=1e3,this.sort="name",this.hubapi=!0,this.results=[],this.catalog=null}async componentWillLoad(){if(this.site){this.catalog=await r(this.site);let t=await this.searchContent(this.query,{groups:this.catalog.groups});this.results=t.results}}async searchContent(t,s){let e=Object.assign({q:t,limit:this.limit,sort:this.sort},s);return console.log("hub-content-table: searchParams",e),await a(e,{isPortal:!this.hubapi,hubApiUrl:"https://hub.arcgis.com",authentication:new l({})})}renderItemLinks(t){switch(t.type){case"Feature Service":return s("ul",{class:"result-formats"},s("li",null,s("a",{href:`https://${this.site}/datasets/${t.id}.zip`},"Shapefile")),s("li",null,s("a",{href:`https://${this.site}/datasets/${t.id}.kml`},"KML")),s("li",null,s("a",{href:`https://${this.site}/datasets/${t.id}.csv`},"CSV")),s("li",null,s("a",{href:`https://${this.site}/datasets/${t.id}.geojson`},"GeoJSON")));case"CSV":return s("a",{href:`https://${this.site}/datasets/${t.id}_0.csv?outSR=4326`},"Download");case"Shapefile":case"PDF":case"Microsoft Excel":return s("a",{href:`https://www.arcgis.com/sharing/rest/content/items/${t.id}/data`},"Download");default:return s("a",{href:t.contentUrl},"Link")}}render(){let t=[];return 0==this.results.length&&t.push(s("calcite-loader",{label:"label",text:"Fetching data...","is-active":!0})),this.results.map((e=>{t.push(s("div",{class:"result"},s("span",{class:"result-name"},s("a",{href:`https://${this.site}/datasets/${e.id}`},e.name),s("em",null,e.summary)),s("span",{class:"result-links"},this.renderItemLinks(e)),s("span",{class:"result-type"},e.type)))})),s(e,null,s("slot",null),s("div",{class:"result result-header"},s("span",{class:"result-name"},"Title"),s("span",{class:"result-links"},"Download"),s("span",{class:"result-type"},"Type")),s("div",{class:"search-results"},t))}};i.style=':host{display:block}.result{display:grid;grid-template:"name links type" auto/\n    50% 30% 20%;padding:1rem 1rem 1rem 3rem;border-bottom:1px solid #DDD}.result-name{grid-area:name}.result-name a{display:block}.result-name em{clear:both;font-size:0.8em;font-color:#333}.result-links{grid-area:links}.result-type{grid-area:type}.result-formats{list-style-type:none;margin:0;padding:0}.result-formats li{display:inline}.result-formats>li+li:before{content:" | ";color:#888}.result-header{border-bottom:2px solid #888;font-weight:500}';export{i as hub_content_table}