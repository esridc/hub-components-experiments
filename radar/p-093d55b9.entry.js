import{r as n,h as t,H as r}from"./p-d703c309.js";import{c as e,a as i,g as o,b as u,d as a}from"./p-16e63a98.js";var c=e((function(n){n.exports=function(n,t,r,e,i){for(t=t.split?t.split("."):t,e=0;e<t.length;e++)n=n?n[t[e]]:i;return n===i?r:n}})),s="undefined"!=typeof window;function f(n){return"function"==typeof n}function l(n){return"string"==typeof n}function d(n){return void 0===n}function h(n){return"boolean"==typeof n}function v(n){if("object"!=typeof n||null===n)return!1;for(var t=n;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t}function p(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch(n){return null}}function m(n){return function(n){for(var t,r=Object.create(null),e=/([^&=]+)=?([^&]*)/g;t=e.exec(n);){var i=p(t[1]),o=p(t[2]);"[]"===i.substring(i.length-2)?(r[i=i.substring(0,i.length-2)]||(r[i]=[])).push(o):r[i]=""===o||o}for(var u in r){var a=u.split("[");a.length>1&&(w(r,a.map((function(n){return n.replace(/[?[\]\\ ]/g,"")})),r[u]),delete r[u])}return r}(function(n){if(n){var t=n.match(/\?(.*)/);return t&&t[1]?t[1].split("#")[0]:""}return s&&window.location.search.substring(1)}(n))}function w(n,t,r){for(var e=t.length-1,i=0;i<e;++i){var o=t[i];if("__proto__"===o||"constructor"===o)break;o in n||(n[o]={}),n=n[o]}n[t[e]]=r}function y(){for(var n="",t=0,r=4294967295*Math.random()|0;t++<36;){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[t-1],i=15&r;n+="-"==e||"4"==e?e:("x"==e?i:3&i|8).toString(16),r=t%8==0?4294967295*Math.random()|0:r>>4}return n}var b="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||void 0,g="undefined";function S(n){return b[n]}function O(n,t){return b[n]=t,t}function k(n){O(n)}var E=function(n){return function(n){if(Array.isArray(n)){for(var t=0,r=new Array(n.length);t<n.length;t++)r[t]=n[t];return r}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()};function A(n,t){return n(t={exports:{}},t.exports),t.exports}var j=A((function(n){function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function r(e){return n.exports=r="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(n){return t(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":t(n)},r(e)}n.exports=r})),x=A((function(n){var t=function(n){var t,r=Object.prototype,e=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(n,t,r){return Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{c({},"")}catch(n){c=function(n,t,r){return n[t]=r}}function s(n,t,r,e){var i=Object.create((t&&t.prototype instanceof m?t:m).prototype),o=new _(e||[]);return i._invoke=function(n,t,r){var e=l;return function(i,o){if(e===h)throw new Error("Generator is already running");if(e===v){if("throw"===i)throw o;return T()}for(r.method=i,r.arg=o;;){var u=r.delegate;if(u){var a=A(u,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===l)throw e=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=h;var c=f(n,t,r);if("normal"===c.type){if(e=r.done?v:d,c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(e=v,r.method="throw",r.arg=c.arg)}}}(n,r,o),i}function f(n,t,r){try{return{type:"normal",arg:n.call(t,r)}}catch(n){return{type:"throw",arg:n}}}n.wrap=s;var l="suspendedStart",d="suspendedYield",h="executing",v="completed",p={};function m(){}function w(){}function y(){}var b={};b[o]=function(){return this};var g=Object.getPrototypeOf,S=g&&g(g(I([])));S&&S!==r&&e.call(S,o)&&(b=S);var O=y.prototype=m.prototype=Object.create(b);function k(n){["next","throw","return"].forEach((function(t){c(n,t,(function(n){return this._invoke(t,n)}))}))}function E(n,t){function r(i,o,u,a){var c=f(n[i],n,o);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==typeof l&&e.call(l,"__await")?t.resolve(l.__await).then((function(n){r("next",n,u,a)}),(function(n){r("throw",n,u,a)})):t.resolve(l).then((function(n){s.value=n,u(s)}),(function(n){return r("throw",n,u,a)}))}a(c.arg)}var i;this._invoke=function(n,e){function o(){return new t((function(t,i){r(n,e,t,i)}))}return i=i?i.then(o,o):o()}}function A(n,r){var e=n.iterator[r.method];if(e===t){if(r.delegate=null,"throw"===r.method){if(n.iterator.return&&(r.method="return",r.arg=t,A(n,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=f(e,n.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var o=i.arg;return o?o.done?(r[n.resultName]=o.value,r.next=n.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function j(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function x(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function _(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(j,this),this.reset(!0)}function I(n){if(n){var r=n[o];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var i=-1,u=function r(){for(;++i<n.length;)if(e.call(n,i))return r.value=n[i],r.done=!1,r;return r.value=t,r.done=!0,r};return u.next=u}}return{next:T}}function T(){return{value:t,done:!0}}return w.prototype=O.constructor=y,y.constructor=w,w.displayName=c(y,a,"GeneratorFunction"),n.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,y):(n.__proto__=y,c(n,a,"GeneratorFunction")),n.prototype=Object.create(O),n},n.awrap=function(n){return{__await:n}},k(E.prototype),E.prototype[u]=function(){return this},n.AsyncIterator=E,n.async=function(t,r,e,i,o){void 0===o&&(o=Promise);var u=new E(s(t,r,e,i),o);return n.isGeneratorFunction(r)?u:u.next().then((function(n){return n.done?n.value:u.next()}))},k(O),c(O,a,"Generator"),O[o]=function(){return this},O.toString=function(){return"[object Generator]"},n.keys=function(n){var t=[];for(var r in n)t.push(r);return t.reverse(),function r(){for(;t.length;){var e=t.pop();if(e in n)return r.value=e,r.done=!1,r}return r.done=!0,r}},n.values=I,_.prototype={constructor:_,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!n)for(var r in this)"t"===r.charAt(0)&&e.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function i(e,i){return a.type="throw",a.arg=n,r.next=e,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],a=u.completion;if("root"===u.tryLoc)return i("end");if(u.tryLoc<=this.prev){var c=e.call(u,"catchLoc"),s=e.call(u,"finallyLoc");if(c&&s){if(this.prev<u.catchLoc)return i(u.catchLoc,!0);if(this.prev<u.finallyLoc)return i(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return i(u.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return i(u.finallyLoc)}}}},abrupt:function(n,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&e.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===n||"continue"===n)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=n,u.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(u)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),p},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===n)return this.complete(r.completion,r.afterLoc),x(r),p}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===n){var e=r.completion;if("throw"===e.type){var i=e.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(n,r,e){return this.delegate={iterator:I(n),resultName:r,nextLoc:e},"next"===this.method&&(this.arg=t),p}},n}(n.exports);try{regeneratorRuntime=t}catch(n){Function("r","regeneratorRuntime = r")(t)}}));function _(n,t,r,e,i,o,u){try{var a=n[o](u),c=a.value}catch(n){return void r(n)}a.done?t(c):Promise.resolve(c).then(e,i)}var I=function(n){return function(){var t=this,r=arguments;return new Promise((function(e,i){var o=n.apply(t,r);function u(n){_(o,e,i,u,a,"next",n)}function a(n){_(o,e,i,u,a,"throw",n)}u(void 0)}))}},T=function(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n};function P(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.push.apply(r,e)}return r}var N=function(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(r,!0).forEach((function(t){T(n,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):P(r).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))}))}return n},M="function",R="undefined",z="@@redux/"+Math.random().toString(36),C=function(){return("undefined"==typeof Symbol?"undefined":j(Symbol))===M&&Symbol.observable||"@@observable"}(),D=" != "+M;function L(n,t,r){if(j(t)===M&&j(r)===R&&(r=t,t=void 0),j(r)!==R){if(j(r)!==M)throw new Error("enhancer"+D);return r(L)(n,t)}if(j(n)!==M)throw new Error("reducer"+D);var e=n,i=t,o=[],u=o,a=!1;function c(){u===o&&(u=o.slice())}function s(){return i}function f(n){if(j(n)!==M)throw new Error("Listener"+D);var t=!0;return c(),u.push(n),function(){if(t){t=!1,c();var r=u.indexOf(n);u.splice(r,1)}}}function l(n){if(!v(n))throw new Error("Act != obj");if(j(n.type)===R)throw new Error("ActType "+R);if(a)throw new Error("Dispatch in reducer");try{a=!0,i=e(i,n)}finally{a=!1}for(var t=o=u,r=0;r<t.length;r++)(0,t[r])();return n}return l({type:"@@redux/INIT"}),T({dispatch:l,subscribe:f,getState:s,replaceReducer:function(n){if(j(n)!==M)throw new Error("next reducer"+D);e=n,l({type:"@@redux/INIT"})}},C,(function(){var n=f;return T({subscribe:function(t){if("object"!==j(t))throw new TypeError("Observer != obj");function r(){t.next&&t.next(s())}return r(),{unsubscribe:n(r)}}},C,(function(){return this}))}))}function U(n,t){var r=t&&t.type;return"action "+(r&&r.toString()||"?")+"reducer "+n+" returns "+R}function H(n){for(var t=Object.keys(n),r={},e=0;e<t.length;e++){var i=t[e];j(n[i])===M&&(r[i]=n[i])}var o,u=Object.keys(r);try{!function(n){Object.keys(n).forEach((function(t){var r=n[t],e=r(void 0,{type:"@@redux/INIT"});if(j(e)===R||j(r(void 0,{type:z}))===R)throw new Error("reducer "+t+" "+R)}))}(r)}catch(n){o=n}return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(o)throw o;for(var e=!1,i={},a=0;a<u.length;a++){var c=u[a],s=r[c],f=n[c],l=s(f,t);if(j(l)===R){var d=U(c,t);throw new Error(d)}i[c]=l,e=e||l!==f}return e?i:n}}function V(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return 0===t.length?function(n){return n}:1===t.length?t[0]:t.reduce((function(n,t){return function(){return n(t.apply(void 0,arguments))}}))}function W(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return function(n){return function(r,e,i){var o,u=n(r,e,i),a=u.dispatch,c={getState:u.getState,dispatch:function(n){return a(n)}};return o=t.map((function(n){return n(c)})),a=V.apply(void 0,E(o))(u.dispatch),N(N({},u),{},{dispatch:a})}}}var q="userId",F="anonymousId",X="__anon_id",G="__user_id",K="__user_traits",B=Object.freeze({ANON_ID:X,USER_ID:G,USER_TRAITS:K}),J=["bootstrap","params","campaign","initializeStart","initialize","initializeEnd","ready","resetStart","reset","resetEnd","pageStart","page","pageEnd","pageAborted","trackStart","track","trackEnd","trackAborted","identifyStart","identify","identifyEnd","identifyAborted","userIdChanged","registerPlugins","enablePlugin","disablePlugin","online","offline","setItemStart","setItem","setItemEnd","setItemAborted","removeItemStart","removeItem","removeItemEnd","removeItemAborted"],$=["name","EVENTS","config","loaded"],Y=J.reduce((function(n,t){return n[t]=t,n}),{registerPluginType:function(n){return"registerPlugin:".concat(n)},pluginReadyType:function(n){return"ready:".concat(n)}});function Z(n){return J.includes(n)}var Q=/^utm_/,nn=/^an_prop_/,tn=/^an_trait_/;function rn(n){var t=n.storage.setItem;return function(r){return function(e){return function(i){if(i.type===Y.bootstrap){var o=i.params,u=i.user,a=i.persistedUser,c=i.initialUser,s=a.userId===u.userId;a.anonymousId!==u.anonymousId&&t(X,u.anonymousId),s||t(G,u.userId),c.traits&&t(K,N(N({},s&&a.traits?a.traits:{}),c.traits));var f=Object.keys(i.params);if(f.length){var l=o.an_uid,d=o.an_event,h=f.reduce((function(n,t){if(t.match(Q)||t.match(/^(d|g)clid/)){var r=t.replace(Q,"");n.campaign["campaign"===r?"name":r]=o[t]}return t.match(nn)&&(n.props[t.replace(nn,"")]=o[t]),t.match(tn)&&(n.traits[t.replace(tn,"")]=o[t]),n}),{campaign:{},props:{},traits:{}});r.dispatch(N(N({type:Y.params,raw:o},h),l?{userId:l}:{})),l&&setTimeout((function(){return n.identify(l,h.traits)}),0),d&&setTimeout((function(){return n.track(d,h.props)}),0),Object.keys(h.campaign).length&&r.dispatch({type:Y.campaign,campaign:h.campaign})}}return e(i)}}}}function en(n){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.type===Y.setItemEnd){if(r.key===X)return N(N({},t),{anonymousId:r.value});if(r.key===G)return N(N({},t),{userId:r.value})}switch(r.type){case Y.identify:return Object.assign({},t,{userId:r.userId,traits:N(N({},t.traits),r.traits)});case Y.reset:return[G,X,K].forEach((function(t){n.removeItem(t)})),Object.assign({},t,{userId:null,anonymousId:null,traits:{}});default:return t}}}function on(n){return{userId:n.getItem(G),anonymousId:n.getItem(X),traits:n.getItem(K)}}var un=function(n){return"__TEMP__"+n};function an(n){return function(t,r,e){var i=r.getState("user")[t];return i||(e&&v(e)&&e[t]?e[t]:on(n)[t]||S(un(t))||null)}}function cn(n){var t=n.storage,r=t.setItem,e=t.removeItem,i=t.getItem;return function(n){return function(t){return function(o){var u=o.userId,a=o.traits,c=o.options;if(o.type===Y.reset&&([G,K,X].forEach((function(n){e(n)})),[q,F,"traits"].forEach((function(n){k(un(n))}))),o.type===Y.identify){i(X)||r(X,y());var s=i(G),f=i(K)||{};s&&s!==u&&n.dispatch({type:Y.userIdChanged,old:{userId:s,traits:f},new:{userId:u,traits:a},options:c}),u&&r(G,u),a&&r(K,N(N({},f),a))}return t(o)}}}}var sn={};function fn(n,t){sn[n]&&f(sn[n])&&(sn[n](t),delete sn[n])}function ln(n,t,r){return new Promise((function(e,i){return t()?e(n):r<1?i(N(N({},n),{},{queue:!0})):(10,new Promise((function(n){return setTimeout(n,10)}))).then((function(){return ln(n,t,r-10).then(e,i)}))}))}function dn(n,t,r){var e=t(),i=n.getState(),o=i.plugins,u=i.queue,a=i.user;if(!i.context.offline&&u&&u.actions&&u.actions.length){var c=u.actions.reduce((function(n,t,r){return o[t.plugin].loaded?(n.process.push(t),n.processIndex.push(r)):(n.requeue.push(t),n.requeueIndex.push(r)),n}),{processIndex:[],process:[],requeue:[],requeueIndex:[]});if(c.processIndex&&c.processIndex.length){c.processIndex.forEach((function(t){var i=u.actions[t],c=i.plugin,s=i.payload.type,l=e[c][s];if(l&&f(l)){var d=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[q,F].reduce((function(r,e){return n.hasOwnProperty(e)&&t[e]&&t[e]!==n[e]&&(r[e]=t[e]),r}),n)}(i.payload,a);l({payload:d,config:o[c].config,instance:r});var h="".concat(s,":").concat(c);n.dispatch(N(N({},d),{},{type:h,_:{called:h,from:"queueDrain"}}))}}));var s=u.actions.filter((function(n,t){return!~c.processIndex.indexOf(t)}));u.actions=s}}}function hn(n,t,r){return setInterval((function(){return dn(n,t,r)}),3e3)}var vn=function(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var r=[],e=!0,i=!1,o=void 0;try{for(var u,a=n[Symbol.iterator]();!(e=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);e=!0);}catch(n){i=!0,o=n}finally{try{e||null==a.return||a.return()}finally{if(i)throw o}}return r}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()};function pn(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(n).filter((function(n){var e=r.plugins||{};return h(e[n])?e[n]:!1!==e.all&&(!t[n]||!1!==t[n].enabled)})).map((function(t){return n[t]}))}var mn=/Start$/,wn=/^bootstrap/,yn=/^ready/;function bn(n,t,r,e,i){return gn.apply(this,arguments)}function gn(){return(gn=I(x.mark((function n(t,r,e,i,o){var u,a,c,s,l,d,h,v,p,m,w;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(u=f(r)?r():r,c=(a=t.type).replace(mn,""),!t._||!t._.called){n.next=5;break}return n.abrupt("return",t);case 5:return s=e.getState(),l=pn(u,s.plugins,t.options),a===Y.initializeStart&&t.fromEnable&&(l=Object.keys(s.plugins).filter((function(n){var r=s.plugins[n];return t.plugins.includes(n)&&!r.initialized})).map((function(n){return u[n]}))),d=l.map((function(n){return n.name})),h=xn(a,l),n.next=12,Sn({action:t,data:{exact:h.before,namespaced:h.beforeNS},state:s,allPlugins:u,allMatches:h,instance:e,store:i,EVENTS:o});case 12:if(!In(v=n.sent,d.length)){n.next=15;break}return n.abrupt("return",v);case 15:if(a!==c){n.next=19;break}p=v,n.next=22;break;case 19:return n.next=21,Sn({action:N(N({},v),{},{type:c}),data:{exact:h.during,namespaced:h.duringNS},state:s,allPlugins:u,allMatches:h,instance:e,store:i,EVENTS:o});case 21:p=n.sent;case 22:if(!a.match(mn)){n.next=28;break}return m="".concat(c,"End"),n.next=26,Sn({action:N(N({},p),{},{type:m}),data:{exact:h.after,namespaced:h.afterNS},state:s,allPlugins:u,allMatches:h,instance:e,store:i,EVENTS:o});case 26:(w=n.sent).meta&&w.meta.hasCallback&&fn(w.meta.rid,{payload:w});case 28:return n.abrupt("return",v);case 29:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function Sn(n){return On.apply(this,arguments)}function On(){return(On=I(x.mark((function n(t){var r,e,i,o,u,a,c,s,l,d,h,p,m,w,y,b,g,S;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.data,i=t.instance,u=t.allPlugins,a=t.allMatches,c=t.store,s=t.EVENTS,l=(o=t.state).plugins,d=o.context,p=(h=(e=t.action).type).match(mn),m=r.exact.map((function(n){return n.pluginName})),p&&(m=a.during.map((function(n){return n.pluginName}))),w=Nn(i,m),y=r.exact.reduce((function(n,t){var r=t.pluginName,e=t.methodName,i=!1;return e.match(/^initialize/)||e.match(/^reset/)||(i=!l[r].loaded),d.offline&&e.match(/^(page|track|identify)/)&&(i=!0),n["".concat(r)]=i,n}),{}),n.next=10,r.exact.reduce(function(){var n=I(x.mark((function n(t,o){var a,c;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o.pluginName,n.next=3,t;case 3:if(c=n.sent,!r.namespaced||!r.namespaced[a]){n.next=11;break}return n.next=7,r.namespaced[a].reduce(function(){var n=I(x.mark((function n(t,r){var e,o,c,s;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=function(n,t,r){return function(e,i){var o=r||t;return N(N({},n),{},{abort:{reason:e,plugins:i||[t],caller:h,from:o}})}},n.next=3,t;case 3:if(e=n.sent,r.method&&f(r.method)){n.next=6;break}return n.abrupt("return",e);case 6:return Mn(r.methodName,r.pluginName),n.next=9,r.method({payload:e,instance:i,abort:o(e,a,r.pluginName),config:En(r.pluginName,l,u),plugins:l});case 9:return s=v(c=n.sent)?c:{},n.abrupt("return",Promise.resolve(N(N({},e),s)));case 12:case"end":return n.stop()}}),n)})));return function(t,r,e){return n.apply(this,arguments)}}(),Promise.resolve(e));case 7:c[a]=n.sent,n.next=12;break;case 11:c[a]=e;case 12:return n.abrupt("return",Promise.resolve(c));case 13:case"end":return n.stop()}}),n)})));return function(t,r,e){return n.apply(this,arguments)}}(),Promise.resolve({}));case 10:return b=n.sent,n.next=13,r.exact.reduce(function(){var n=I(x.mark((function n(t,e,o){var a,s,f,d,m,g,S,O,k,E,A;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.exact.length===o+1,f=u[s=e.pluginName],n.next=5,t;case 5:if(d=n.sent,m=b[s]?b[s]:{},p&&(m=d),!_n(m,s)){n.next=11;break}return kn({data:m,method:h,instance:i,pluginName:s,store:c}),n.abrupt("return",Promise.resolve(d));case 11:if(!_n(d,s)){n.next=14;break}return a&&kn({data:d,method:h,instance:i,store:c}),n.abrupt("return",Promise.resolve(d));case 14:if(!y.hasOwnProperty(s)||!0!==y[s]){n.next=17;break}return c.dispatch({type:"queue",plugin:s,payload:m,_:{called:"queue",from:"queueMechanism"}}),n.abrupt("return",Promise.resolve(d));case 17:return g=w(b[s],u[s]),n.next=20,f[h]({abort:g.abort,payload:m,instance:i,config:En(s,l,u),plugins:l});case 20:return O=v(S=n.sent)?S:{},k=N(N({},d),O),_n(E=b[s],s)?kn({data:E,method:h,instance:i,pluginName:s,store:c}):((A="".concat(h,":").concat(s)).match(/:/g)||[]).length<2&&!h.match(wn)&&!h.match(yn)&&i.dispatch(N(N({},p?k:m),{},{type:A,_:{called:A,from:"submethod"}})),n.abrupt("return",Promise.resolve(k));case 26:case"end":return n.stop()}}),n)})));return function(t,r,e){return n.apply(this,arguments)}}(),Promise.resolve(e));case 13:if(g=n.sent,h.match(mn)||h.match(/^registerPlugin/)||h.match(yn)||h.match(wn)||h.match(/^params/)||h.match(/^userIdChanged/)){n.next=21;break}if(s.plugins.includes(h),!g._||g._.originalAction!==h){n.next=18;break}return n.abrupt("return",g);case 18:S=N(N({},g),{_:{originalAction:g.type,called:g.type,from:"engineEnd"}}),In(g,r.exact.length)&&!h.match(/End$/)&&(S=N(N({},S),{type:g.type+"Aborted"})),c.dispatch(S);case 21:return n.abrupt("return",g);case 22:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function kn(n){var t=n.pluginName,r=n.method+"Aborted"+(t?":"+t:"");n.store.dispatch(N(N({},n.data),{},{type:r,_:{called:r,from:"abort"}}))}function En(n,t,r){var e=t[n]||r[n];return e&&e.config?e.config:{}}function An(n,t){return t.reduce((function(t,r){return r[n]?t.concat({methodName:n,pluginName:r.name,method:r[n]}):t}),[])}function jn(n,t){var r=n.replace(mn,""),e=t?":".concat(t):"";return["".concat(n).concat(e),"".concat(r).concat(e),"".concat(r,"End").concat(e)]}function xn(n,t){var r=jn(n).map((function(n){return An(n,t)}));return t.reduce((function(r,e){var i=e.name,o=jn(n,i).map((function(n){return An(n,t)})),u=vn(o,3),a=u[0],c=u[1],s=u[2];return a.length&&(r.beforeNS[i]=a),c.length&&(r.duringNS[i]=c),s.length&&(r.afterNS[i]=s),r}),{before:r[0],beforeNS:{},during:r[1],duringNS:{},after:r[2],afterNS:{}})}function _n(n,t){var r=n.abort;return!!r&&(!0===r||Pn(r,t)||r&&Pn(r.plugins,t))}function In(n,t){var r=n.abort;if(!r)return!1;if(!0===r||l(r))return!0;var e=r.plugins;return Tn(r)&&r.length===t||Tn(e)&&e.length===t}function Tn(n){return Array.isArray(n)}function Pn(n,t){return!(!n||!Tn(n))&&n.includes(t)}function Nn(n,t){return function(r,e,i){var o=e.config,u=e.name,a="".concat(u,".").concat(r.type);i&&(a=i.event);var c=r.type.match(mn)?function(n,t,r,e,i){return function(o,u){var a=e?e.name:n,c=u&&Tn(u)?u:r;if(e&&(!(c=u&&Tn(u)?u:[n]).includes(n)||1!==c.length))throw new Error("Method ".concat(t," can only abort ").concat(n," plugin. ").concat(JSON.stringify(c)," input valid"));return N(N({},i),{},{abort:{reason:o,plugins:c,caller:t,_:a}})}}(u,a,t,i,r):function(n,t){return function(){throw new Error(n.type+" action not cancellable. Remove abort in "+t)}}(r,a);return{payload:zn(r),instance:n,config:o||{},abort:c}}}function Mn(n,t){var r=Rn(n);if(r&&r.name===t){var e=Rn(r.method),i=e?"or "+e.method:"";throw new Error([t+" plugin is calling method "+n,"Plugins cant call self","Use ".concat(r.method," ").concat(i," in ").concat(t," plugin insteadof ").concat(n)].join("\n"))}}function Rn(n){var t=n.match(/(.*):(.*)/);return!!t&&{method:t[1],name:t[2]}}function zn(n){return Object.keys(n).reduce((function(t,r){return"type"===r||(t[r]=v(n[r])?Object.assign({},n[r]):n[r]),t}),{})}function Cn(n,t,r){var e={};return function(i){return function(o){return function(){var u=I(x.mark((function u(a){var c,s,f,l,d,h,v,p,m,w;return x.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(c=a.type,s=a.plugins,f=a,!a.abort){u.next=4;break}return u.abrupt("return",o(a));case 4:if(c===Y.enablePlugin&&i.dispatch({type:Y.initializeStart,plugins:s,disabled:[],fromEnable:!0,meta:a.meta}),c===Y.disablePlugin&&setTimeout((function(){return fn(a.meta.rid,{payload:a})}),0),c===Y.initializeEnd&&(l=t(),d=Object.keys(l),h=d.filter((function(n){return s.includes(n)})).map((function(n){return l[n]})),v=[],p=[],m=a.disabled,w=h.map((function(n){var t=n.name;return ln(n,n.loaded,1e4).then((function(){return e[t]||(i.dispatch({type:Y.pluginReadyType(t),name:t,events:Object.keys(n).filter((function(n){return!$.includes(n)}))}),e[t]=!0),v=v.concat(t),n})).catch((function(n){if(n instanceof Error)throw new Error(n);return p=p.concat(n.name),n}))})),Promise.all(w).then((function(){var n={plugins:v,failed:p,disabled:m};setTimeout((function(){d.length===w.length+m.length&&i.dispatch(N(N({},{type:Y.ready}),n))}),0)}))),c===Y.bootstrap){u.next=13;break}return/^ready:([^:]*)$/.test(c)&&setTimeout((function(){return dn(i,t,n)}),0),u.next=11,bn(a,t,n,i,r);case 11:return u.abrupt("return",o(u.sent));case 13:return u.abrupt("return",o(f));case 14:case"end":return u.stop()}}),u)})));return function(n){return u.apply(this,arguments)}}()}}}function Dn(n){return function(){return function(t){return function(r){var e=r.type,i=r.key,o=r.value,u=r.options;if(e===Y.setItem||e===Y.removeItem){if(r.abort)return t(r);e===Y.setItem?n.setItem(i,o,u):n.removeItem(i,u)}return t(r)}}}}var Ln=function n(){var t=this;(function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),T(this,"before",[]),T(this,"after",[]),T(this,"addMiddleware",(function(n,r){t[r]=t[r].concat(n)})),T(this,"removeMiddleware",(function(n,r){var e=t[r].findIndex((function(t){return t===n}));-1!==e&&(t[r]=[].concat(E(t[r].slice(0,e)),E(t[r].slice(e+1))))})),T(this,"dynamicMiddlewares",(function(n){return function(r){return function(e){return function(i){var o={getState:r.getState,dispatch:function(n){return r.dispatch(n)}},u=t[n].map((function(n){return n(o)}));return V.apply(void 0,E(u))(e)(i)}}}}))};function Un(n){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,e={};if("initialize:aborted"===r.type)return t;if(/^registerPlugin:([^:]*)$/.test(r.type)){var i=Hn(r.type,"registerPlugin"),o=n()[i];if(!o||!i)return t;var u=r.enabled;return e[i]={enabled:u,initialized:!!u&&Boolean(!o.initialize),loaded:!!u&&Boolean(o.loaded()),config:o.config||{}},N(N({},t),e)}if(/^initialize:([^:]*)$/.test(r.type)){var a=Hn(r.type,Y.initialize),c=n()[a];return c&&a?(e[a]=N(N({},t[a]),{initialized:!0,loaded:Boolean(c.loaded())}),N(N({},t),e)):t}if(/^ready:([^:]*)$/.test(r.type))return e[r.name]=N(N({},t[r.name]),{loaded:!0}),N(N({},t),e);switch(r.type){case Y.disablePlugin:return N(N({},t),Vn(r.plugins,!1,t));case Y.enablePlugin:return N(N({},t),Vn(r.plugins,!0,t));default:return t}}}function Hn(n,t){return n.substring(t.length+1,n.length)}function Vn(n,t,r){return n.reduce((function(n,e){return n[e]=N(N({},r[e]),{enabled:t}),n}),r)}function Wn(n){try{return JSON.parse(JSON.stringify(n))}catch(n){}return n}var qn={last:{},history:[]};function Fn(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qn,t=arguments.length>1?arguments[1]:void 0,r=t.type,e=t.event,i=t.properties,o=t.options,u=t.meta;switch(r){case Y.track:var a=Wn(N(N({event:e,properties:i},Object.keys(o).length&&{options:o}),{},{meta:u}));return N(N({},n),{last:a,history:n.history.concat(a)});default:return n}}var Xn={actions:[]};function Gn(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn,t=arguments.length>1?arguments[1]:void 0,r=t.type,e=t.payload;switch(r){case"queue":var i;return i=e&&e.type&&e.type===Y.identify?[t].concat(n.actions):n.actions.concat(t),N(N({},n),{},{actions:i});case"dequeue":return[];default:return n}}var Kn=/#.*$/;function Bn(n){var t=/(http[s]?:\/\/)?([^\/\s]+\/)(.*)/g.exec(n);return"/"+(t&&t[3]?t[3].split("?")[0].replace(Kn,""):"")}function Jn(n){var t=function(){if(s)for(var n,t=document.getElementsByTagName("link"),r=0;n=t[r];r++)if("canonical"===n.getAttribute("rel"))return n.getAttribute("href")}();return t?t.match(/\?/)?t:t+n:window.location.href.replace(Kn,"")}var $n,Yn,Zn,Qn,nt=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!s)return n;var t=document,r=t.title,e=t.referrer,i=window,o=i.location,u=i.innerWidth,a=i.innerHeight,c=o.hash,f=o.search,l=Jn(f),d={title:r,url:l,path:Bn(l),hash:c,search:f,width:u,height:a};return e&&""!==e&&(d.referrer=e),N(N({},d),n)},tt={last:{},history:[]};function rt(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments.length>1?arguments[1]:void 0,r=t.properties,e=t.options,i=t.meta;switch(t.type){case Y.page:var o=Wn(N({properties:r,meta:i},Object.keys(e).length&&{options:e}));return N(N({},n),{last:o,history:n.history.concat(o)});default:return n}}$n=function(){if(!s)return!1;var n=navigator.appVersion;return~n.indexOf("Win")?"Windows":~n.indexOf("Mac")?"MacOS":~n.indexOf("X11")?"UNIX":~n.indexOf("Linux")?"Linux":"Unknown OS"}(),Yn=s?document.referrer:null,Zn=function(){if(s){var n=navigator,t=n.languages;return n.userLanguage||(t&&t.length?t[0]:n.language)}}(),Qn=function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(n){}}();var et={initialized:!1,sessionId:y(),app:null,version:null,debug:!1,offline:!!s&&!navigator.onLine,os:{name:$n},userAgent:s?navigator.userAgent:"node",library:{name:"analytics",version:"0.10.17"},timezone:Qn,locale:Zn,campaign:{},referrer:Yn};function it(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0,r=n.initialized,e=t.type,i=t.campaign;switch(e){case Y.campaign:return N(N({},n),{campaign:i});case Y.offline:return N(N({},n),{offline:!0});case Y.online:return N(N({},n),{offline:!1});default:return r?n:N(N(N({},et),n),{initialized:!0})}}var ot=["plugins","reducers","storage"];function ut(n){return Object.keys(n).reduce((function(t,r){return ot.includes(r)||(t[r]=n[r]),t}),{})}function at(n,t,r){if(s){var e=window[(r?"add":"remove")+"EventListener"];n.split(" ").forEach((function(n){e(n,t)}))}}function ct(n){var t=at.bind(null,"online offline",(function(){return Promise.resolve(!navigator.onLine).then(n)}));return t(!0),function(){return t(!1)}}function st(){return O("__analytics__",[]),function(n){return function(t,r,e){var i=n(t,r,e),o=i.dispatch;return Object.assign(i,{dispatch:function(n){return b.__analytics__.push(n.action||n),o(n)}})}}}function ft(){return function(){return V(V.apply(null,arguments),st())}}function lt(n){return n?"[object Array]"===Object.prototype.toString.call(n)?n:[n]:[]}function dt(n){for(var t,r=n||Array.prototype.slice.call(arguments),e=0;e<r.length;e++)if(f(r[e])){t=r[e];break}return t}function ht(){return(new Date).getTime()}function vt(n,t){return function(r){t&&t(r),n(r)}}function pt(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,e=y();return t&&(sn[e]=vt(t,dt(r))),N(N({},n),{},{rid:e,ts:ht()},t?{hasCallback:!0}:{})}function mt(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.reducers||{},r=n.initialUser||{},e=(n.plugins||[]).reduce((function(n,t){if(f(t))return n.middlewares=n.middlewares.concat(t),n;if(t.NAMESPACE&&(t.name=t.NAMESPACE),!t.name)throw new Error("https://lytics.dev/errors/1");var r=t.EVENTS?Object.keys(t.EVENTS).map((function(n){return t.EVENTS[n]})):[];n.pluginEnabled[t.name]=!(!1===t.enabled||t.config&&!1===t.config.enabled),delete t.enabled,t.methods&&(n.methods[t.name]=Object.keys(t.methods).reduce((function(n,r){return n[r]=yn(t.methods[r]),n}),{}),delete t.methods);var e=Object.keys(t).concat(r),i=new Set(n.events.concat(e));if(n.events=Array.from(i),n.pluginsArray=n.pluginsArray.concat(t),n.plugins[t.name])throw new Error(t.name+"AlreadyLoaded");return n.plugins[t.name]=t,n.plugins[t.name].loaded||(n.plugins[t.name].loaded=function(){return!0}),n}),{plugins:{},pluginEnabled:{},methods:{},pluginsArray:[],middlewares:[],events:[]}),i=n.storage?n.storage:{getItem:S,setItem:O,removeItem:k},o=an(i),u=e.plugins,a=e.events.filter((function(n){return!$.includes(n)})).sort(),d=new Set(a.concat(J).filter((function(n){return!$.includes(n)}))),h=Array.from(d).sort(),p=function(){return u},w=new Ln,b=w.addMiddleware,g=w.removeMiddleware,A=w.dynamicMiddlewares,_=function(){throw new Error("Abort disabled inListener")},T=m(),P=on(i),M=N(N(N(N({},P),r),T.an_uid?{userId:T.an_uid}:{}),T.an_aid?{anonymousId:T.an_aid}:{});M.anonymousId||(M.anonymousId=y());var R,z,C,D=N({enable:function(n,t){return new Promise((function(r){dn.dispatch({type:Y.enablePlugin,plugins:lt(n),_:{originalAction:Y.enablePlugin}},r,[t])}))},disable:function(n,t){return new Promise((function(r){dn.dispatch({type:Y.disablePlugin,plugins:lt(n),_:{originalAction:Y.disablePlugin}},r,[t])}))}},e.methods),U={identify:(C=I(x.mark((function n(t,r,e,i){var u,a,c,s,f;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=l(t)?t:null,a=v(t)?t:r,c=e||{},s=U.user(),O(un(q),u),f=u||a.userId||o(q,U,a),n.abrupt("return",new Promise((function(n){dn.dispatch(N({type:Y.identifyStart,userId:f,traits:a||{},options:c,anonymousId:s.anonymousId},s.id&&s.id!==u&&{previousId:s.id}),n,[r,e,i])})));case 7:case"end":return n.stop()}}),n)}))),function(n,t,r,e){return C.apply(this,arguments)}),track:(z=I(x.mark((function n(t,r,e,i){var u,a,c;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((u=v(t)?t.event:t)&&l(u)){n.next=3;break}throw new Error("EventMissing");case 3:return a=v(t)?t:r||{},c=v(e)?e:{},n.abrupt("return",new Promise((function(n){dn.dispatch({type:Y.trackStart,event:u,properties:a,options:c,userId:o(q,U,r),anonymousId:o(F,U,r)},n,[r,e,i])})));case 6:case"end":return n.stop()}}),n)}))),function(n,t,r,e){return z.apply(this,arguments)}),page:(R=I(x.mark((function n(t,r,e){var i,u;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=v(t)?t:{},u=v(r)?r:{},n.abrupt("return",new Promise((function(n){dn.dispatch({type:Y.pageStart,properties:nt(i),options:u,userId:o(q,U,i),anonymousId:o(F,U,i)},n,[t,r,e])})));case 3:case"end":return n.stop()}}),n)}))),function(n,t,r){return R.apply(this,arguments)}),user:function(n){if(n===q||"id"===n)return o(q,U);if(n===F||"anonId"===n)return o(F,U);var t=U.getState("user");return n?c(t,n):t},reset:function(n){return new Promise((function(t){dn.dispatch({type:Y.resetStart},t,n)}))},ready:function(n){return U.on(Y.ready,n)},on:function(n,t){if(!n||!f(t))return!1;if(n===Y.bootstrap)throw new Error(".on disabled for "+n);var r=/Start$|Start:/;if("*"===n){var e=function(){return function(n){return function(e){return e.type.match(r)&&t({payload:e,instance:U,plugins:u}),n(e)}}},i=function(){return function(n){return function(e){return e.type.match(r)||t({payload:e,instance:U,plugins:u}),n(e)}}};return b(e,wt),b(i,yt),function(){g(e,wt),g(i,yt)}}var o=n.match(r)?wt:yt,a=function(){return function(r){return function(e){return e.type===n&&t({payload:e,instance:U,plugins:u,abort:_}),r(e)}}};return b(a,o),function(){return g(a,o)}},once:function(n,t){if(!n||!f(t))return!1;if(n===Y.bootstrap)throw new Error(".once disabled for "+n);var r=U.on(n,(function(n){t({payload:n.payload,instance:U,plugins:u,abort:_}),r()}));return r},getState:function(n){var t=dn.getState();return n?c(t,n):Object.assign({},t)},dispatch:function(n){var t=l(n)?{type:n}:n;if(Z(t.type))throw new Error("reserved action "+t.type);var r=n._||{},e=N(N({},t),{},{_:N({originalAction:t.type},r)});dn.dispatch(e)},enablePlugin:D.enable,disablePlugin:D.disable,plugins:D,storage:{getItem:i.getItem,setItem:function(n,t,r){dn.dispatch({type:Y.setItemStart,key:n,value:t,options:r})},removeItem:function(n,t){dn.dispatch({type:Y.removeItemStart,key:n,options:t})}},setAnonymousId:function(n,t){U.storage.setItem(X,n,t)},events:{all:h,core:J,plugins:a}},G=function(){return function(n){return function(t){return t.meta||(t.meta=pt()),n(t)}}},K=e.middlewares.concat([G,A(wt),Cn(U,p,{all:h,plugins:a}),Dn(i),rn(U),cn(U),A(yt)]),B={context:it,user:en(i),page:rt,track:Fn,plugins:Un(p),queue:Gn},Q=V,nn=V;if(s&&n.debug){var tn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;tn&&(Q=tn({trace:!0,traceLimit:25})),nn=function(){return 0===arguments.length?st():v(j(arguments[0]))?ft():ft().apply(null,arguments)}}var sn=ut(n),fn=e.pluginsArray.reduce((function(n,t){var r=t.name,i=t.config,o=t.loaded,u=e.pluginEnabled[r];return n[r]={enabled:u,initialized:!!u&&Boolean(!t.initialize),loaded:Boolean(o()),config:i||{}},n}),{}),ln={context:sn,user:M,plugins:fn},dn=L(H(N(N({},B),t)),ln,nn(Q(W.apply(void 0,E(K)))));function vn(n){return function(t,r,e){var i=pt(t.meta,r,lt(e)),o=N(N({},t),{meta:i});return n.apply(null,[o])}}dn.dispatch=vn(dn.dispatch);var pn=Object.keys(u);dn.dispatch({type:Y.bootstrap,plugins:pn,config:sn,params:T,user:M,initialUser:r,persistedUser:P});var mn=pn.filter((function(n){return e.pluginEnabled[n]})),wn=pn.filter((function(n){return!e.pluginEnabled[n]}));function yn(n){return function(){for(var t=Array.prototype.slice.call(arguments),r=new Array(n.length),e=0;e<t.length;e++)r[e]=t[e];return r[r.length]=U,n.apply({instance:U},r)}}return dn.dispatch({type:Y.registerPlugins,plugins:pn,enabled:e.pluginEnabled}),e.pluginsArray.map((function(n,t){var r=n.bootstrap,i=n.config,o=n.name;r&&f(r)&&r({instance:U,config:i,payload:n}),dn.dispatch({type:Y.registerPluginType(o),name:o,enabled:e.pluginEnabled[o],plugin:n}),e.pluginsArray.length===t+1&&dn.dispatch({type:Y.initializeStart,plugins:mn,disabled:wn})})),ct((function(n){dn.dispatch({type:n?Y.offline:Y.online})})),hn(dn,p,U),U}var wt="before",yt="after",bt=kt(),gt=Et,St=Et;function Ot(n){return bt?Et(n,"",-1):k(n)}function kt(){if(typeof bt!==g)return bt;try{Et("__x","__x"),bt=-1!==document.cookie.indexOf("__x"),Ot("__x")}catch(n){bt=!1}return bt}function Et(n,t,r,e,i,o){if(typeof window!==g){var u=arguments.length>1;return bt||(u?O(n,t):S(n)),u?document.cookie=n+"="+encodeURIComponent(t)+(r?"; expires="+new Date(+new Date+1e3*r).toUTCString()+(e?"; path="+e:"")+(i?"; domain="+i:"")+(o?"; secure":""):""):decodeURIComponent((("; "+document.cookie).split("; "+n+"=")[1]||"").split(";")[0])}}var At=jt();function jt(){if(typeof At!==g)return At;At=!0;try{typeof localStorage!==g&&typeof JSON!==g||(At=!1),localStorage.setItem(g,g),localStorage.removeItem(g)}catch(n){At=!1}return At}function xt(n){var t=n;try{if("true"===(t=JSON.parse(n)))return!0;if("false"===t)return!1;if(v(t))return t;parseFloat(t)===t&&(t=parseFloat(t))}catch(n){}if(null!==t&&""!==t)return t}var _t=jt(),It=kt();function Tt(n,t){if(n){var r=Pt(t),e=!Rt(r),i=Nt(r)?xt(localStorage.getItem(n)):void 0;if(e&&!d(i))return i;var o=Mt(r)?xt(gt(n)):void 0;if(e&&o)return o;var u=S(n);return e?u:{localStorage:i,cookie:o,global:u}}}function Pt(n){return n?l(n)?n:n.storage:"any"}function Nt(n){return _t&&zt(n,"localStorage")}function Mt(n){return It&&zt(n,"cookie")}function Rt(n){return"*"===n||"all"===n}function zt(n,t){return"any"===n||n===t||Rt(n)}var Ct={setItem:function(n,t,r){if(n&&!d(t)){var e={},i=Pt(r),o=JSON.stringify(t),u=!Rt(i);return Nt(i)&&(e.localStorage={location:"localStorage",current:t,previous:xt(localStorage.getItem(n))},localStorage.setItem(n,o),u)?e.localStorage:Mt(i)&&(e.cookie={location:"cookie",current:t,previous:xt(gt(n))},St(n,o),u)?e.cookie:(e.global={location:"global",current:t,previous:S(n)},O(n,t),u?e.global:e)}},getItem:Tt,removeItem:function(n,t){if(n){var r=Pt(t),e=Tt(n,"*"),i={};return!d(e.localStorage)&&Nt(r)&&(localStorage.removeItem(n),i.localStorage=e.localStorage),!d(e.cookie)&&Mt(r)&&(Ot(n),i.cookie=e.cookie),!d(e.global)&&zt(r,"global")&&(k(n),i.global=e.global),i}}},Dt=function(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n};function Lt(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.push.apply(r,e)}return r}var Ut=function(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(r,!0).forEach((function(t){Dt(n,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Lt(r).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))}))}return n};function Ht(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={storage:Ct};return mt(Ut(Ut({},t),n))}const Vt=Object.freeze({__proto__:null,default:Ht,init:Ht,Analytics:Ht,EVENTS:Y,CONSTANTS:B});var Wt=function(n){return function(n){return!!n&&"object"==typeof n}(n)&&!function(n){var t=Object.prototype.toString.call(n);return"[object RegExp]"===t||"[object Date]"===t||function(n){return n.$$typeof===qt}(n)}(n)},qt="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function Ft(n,t){return!1!==t.clone&&t.isMergeableObject(n)?Bt(Array.isArray(n)?[]:{},n,t):n}function Xt(n,t,r){return n.concat(t).map((function(n){return Ft(n,r)}))}function Gt(n){return Object.keys(n).concat(function(n){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n).filter((function(t){return n.propertyIsEnumerable(t)})):[]}(n))}function Kt(n,t){try{return t in n}catch(n){return!1}}function Bt(n,t,r){(r=r||{}).arrayMerge=r.arrayMerge||Xt,r.isMergeableObject=r.isMergeableObject||Wt,r.cloneUnlessOtherwiseSpecified=Ft;var e=Array.isArray(t);return e===Array.isArray(n)?e?r.arrayMerge(n,t,r):function(n,t,r){var e={};return r.isMergeableObject(n)&&Gt(n).forEach((function(t){e[t]=Ft(n[t],r)})),Gt(t).forEach((function(i){(function(n,t){return Kt(n,t)&&!(Object.hasOwnProperty.call(n,t)&&Object.propertyIsEnumerable.call(n,t))})(n,i)||(e[i]=Kt(n,i)&&r.isMergeableObject(t[i])?function(n,t){if(!t.customMerge)return Bt;var r=t.customMerge(n);return"function"==typeof r?r:Bt}(i,r)(n[i],t[i],r):Ft(t[i],r))})),e}(n,t,r):Ft(t,r)}Bt.all=function(n,t){if(!Array.isArray(n))throw new Error("first argument should be an array");return n.reduce((function(n,r){return Bt(n,r,t)}),{})};var Jt=Bt;function $t(){for(var n="",t=0,r=4294967295*Math.random()|0;t++<36;){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[t-1],i=15&r;n+="-"==e||"4"==e?e:("x"==e?i:3&i|8).toString(16),r=t%8==0?4294967295*Math.random()|0:r>>4}return n}var Yt=e((function(n,t){!function(n){
/**
   * @license MIT <https://opensource.org/licenses/MIT>
   * @copyright Michael Hart 2018
   */
const t=new TextEncoder,r={appstream2:"appstream",cloudhsmv2:"cloudhsm",email:"ses",marketplace:"aws-marketplace",mobile:"AWSMobileHubService",pinpoint:"mobiletargeting",queue:"sqs","git-codecommit":"codecommit","mturk-requester-sandbox":"mturk-requester","personalize-runtime":"personalize"},e=["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id","range","connection"];class i{constructor({method:n,url:t,headers:i,body:o,accessKeyId:u,secretAccessKey:a,sessionToken:s,service:f,region:l,cache:d,datetime:h,signQuery:v,appendSessionToken:p,allHeaders:m,singleEncode:w}){if(null==t)throw new TypeError("url is a required option");if(null==u)throw new TypeError("accessKeyId is a required option");if(null==a)throw new TypeError("secretAccessKey is a required option");let y,b;this.method=n||(o?"POST":"GET"),this.url=new URL(t),this.headers=new Headers(i||{}),this.body=o,this.accessKeyId=u,this.secretAccessKey=a,this.sessionToken=s,f&&l||([y,b]=function(n,t){const{hostname:e,pathname:i}=n,o=e.replace("dualstack.","").match(/([^.]+)\.(?:([^.]*)\.)?amazonaws\.com(?:\.cn)?$/);let[u,a]=(o||["",""]).slice(1,3);if("us-gov"===a)a="us-gov-west-1";else if("s3"===a||"s3-accelerate"===a)a="us-east-1",u="s3";else if("iot"===u)u=e.startsWith("iot.")?"execute-api":e.startsWith("data.jobs.iot.")?"iot-jobs-data":"/mqtt"===i?"iotdevicegateway":"iotdata";else if("autoscaling"===u){const n=(t.get("X-Amz-Target")||"").split(".")[0];"AnyScaleFrontendService"===n?u="application-autoscaling":"AnyScaleScalingPlannerFrontendService"===n&&(u="autoscaling-plans")}else null==a&&u.startsWith("s3-")?(a=u.slice(3).replace(/^fips-|^external-1/,""),u="s3"):u.endsWith("-fips")?u=u.slice(0,-5):a&&/-\d$/.test(u)&&!/-\d$/.test(a)&&([u,a]=[a,u]);return[r[u]||u,a]}(this.url,this.headers)),this.service=f||y||"",this.region=l||b||"us-east-1",this.cache=d||new Map,this.datetime=h||(new Date).toISOString().replace(/[:-]|\.\d{3}/g,""),this.signQuery=v,this.appendSessionToken=p||"iotdevicegateway"===this.service,this.headers.delete("Host");const g=this.signQuery?this.url.searchParams:this.headers;if("s3"!==this.service||this.headers.has("X-Amz-Content-Sha256")||this.headers.set("X-Amz-Content-Sha256","UNSIGNED-PAYLOAD"),g.set("X-Amz-Date",this.datetime),this.sessionToken&&!this.appendSessionToken&&g.set("X-Amz-Security-Token",this.sessionToken),this.signableHeaders=["host",...this.headers.keys()].filter((n=>m||!e.includes(n))).sort(),this.signedHeaders=this.signableHeaders.join(";"),this.canonicalHeaders=this.signableHeaders.map((n=>n+":"+("host"===n?this.url.host:(this.headers.get(n)||"").replace(/\s+/g," ")))).join("\n"),this.credentialString=[this.datetime.slice(0,8),this.region,this.service,"aws4_request"].join("/"),this.signQuery&&("s3"!==this.service||g.has("X-Amz-Expires")||g.set("X-Amz-Expires","86400"),g.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),g.set("X-Amz-Credential",this.accessKeyId+"/"+this.credentialString),g.set("X-Amz-SignedHeaders",this.signedHeaders)),"s3"===this.service)try{this.encodedPath=decodeURIComponent(this.url.pathname.replace(/\+/g," "))}catch(n){this.encodedPath=this.url.pathname}else this.encodedPath=this.url.pathname.replace(/\/+/g,"/");w||(this.encodedPath=encodeURIComponent(this.encodedPath).replace(/%2F/g,"/")),this.encodedPath=c(this.encodedPath);const S=new Set;this.encodedSearch=[...this.url.searchParams].filter((([n])=>{if(!n)return!1;if("s3"===this.service){if(S.has(n))return!1;S.add(n)}return!0})).map((n=>n.map((n=>c(encodeURIComponent(n)))))).sort((([n,t],[r,e])=>n<r?-1:n>r?1:t<e?-1:t>e?1:0)).map((n=>n.join("="))).join("&")}async sign(){return this.signQuery?(this.url.searchParams.set("X-Amz-Signature",await this.signature()),this.sessionToken&&this.appendSessionToken&&this.url.searchParams.set("X-Amz-Security-Token",this.sessionToken)):this.headers.set("Authorization",await this.authHeader()),{method:this.method,url:this.url,headers:this.headers,body:this.body}}async authHeader(){return["AWS4-HMAC-SHA256 Credential="+this.accessKeyId+"/"+this.credentialString,"SignedHeaders="+this.signedHeaders,"Signature="+await this.signature()].join(", ")}async signature(){const n=this.datetime.slice(0,8),t=[this.secretAccessKey,n,this.region,this.service].join();let r=this.cache.get(t);if(!r){const e=await o("AWS4"+this.secretAccessKey,n),i=await o(e,this.region),u=await o(i,this.service);r=await o(u,"aws4_request"),this.cache.set(t,r)}return a(await o(r,await this.stringToSign()))}async stringToSign(){return["AWS4-HMAC-SHA256",this.datetime,this.credentialString,a(await u(await this.canonicalString()))].join("\n")}async canonicalString(){return[this.method.toUpperCase(),this.encodedPath,this.encodedSearch,this.canonicalHeaders+"\n",this.signedHeaders,await this.hexBodyHash()].join("\n")}async hexBodyHash(){let n=this.headers.get("X-Amz-Content-Sha256");if(null==n){if(this.body&&"string"!=typeof this.body&&!("byteLength"in this.body))throw new Error("body must be a string, ArrayBuffer or ArrayBufferView, unless you include the X-Amz-Content-Sha256 header");n=a(await u(this.body||""))}return n}}async function o(n,r){const e=await crypto.subtle.importKey("raw","string"==typeof n?t.encode(n):n,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return crypto.subtle.sign("HMAC",e,t.encode(r))}async function u(n){return crypto.subtle.digest("SHA-256","string"==typeof n?t.encode(n):n)}function a(n){return Array.prototype.map.call(new Uint8Array(n),(n=>("0"+n.toString(16)).slice(-2))).join("")}function c(n){return n.replace(/[!'()*]/g,(n=>"%"+n.charCodeAt(0).toString(16).toUpperCase()))}n.AwsClient=class{constructor({accessKeyId:n,secretAccessKey:t,sessionToken:r,service:e,region:i,cache:o,retries:u,initRetryMs:a}){if(null==n)throw new TypeError("accessKeyId is a required option");if(null==t)throw new TypeError("secretAccessKey is a required option");this.accessKeyId=n,this.secretAccessKey=t,this.sessionToken=r,this.service=e,this.region=i,this.cache=o||new Map,this.retries=null!=u?u:10,this.initRetryMs=a||50}async sign(n,t){if(n instanceof Request){const{method:r,url:e,headers:i,body:o}=n;null==(t=Object.assign({method:r,url:e,headers:i},t)).body&&i.has("Content-Type")&&(t.body=null!=o&&i.has("X-Amz-Content-Sha256")?o:await n.clone().arrayBuffer()),n=e}const r=new i(Object.assign({url:n},t,this,t&&t.aws)),e=Object.assign({},t,await r.sign());return delete e.aws,new Request(e.url.toString(),e)}async fetch(n,t){for(let r=0;r<=this.retries;r++){const e=fetch(await this.sign(n,t));if(r===this.retries)return e;const i=await e;if(i.status<500&&429!==i.status)return i;await new Promise((n=>setTimeout(n,Math.random()*this.initRetryMs*Math.pow(2,r))))}throw new Error("An unknown error occurred, ensure retries is not negative")}},n.AwsV4Signer=i,Object.defineProperty(n,"__esModule",{value:!0})}(t)})),Zt="undefined"==typeof window;function Qt(n){if(Zt)return!1;var t=Zt||"hidden"in document?"hidden":["webkit","moz","ms","o"].reduce((function(n,t){var r=t+"Hidden";return!n&&r in document?r:n}),null),r="".concat(t.replace(/[H|h]idden/,""),"visibilitychange"),e=function(){return n(Boolean(document[t]))};return document.addEventListener(r,e),function(){return document.removeEventListener(r,e)}}function nr(n,t,r,e,i,o,u){try{var a=n[o](u),c=a.value}catch(n){return void r(n)}a.done?t(c):Promise.resolve(c).then(e,i)}function tr(n){return function(){var t=this,r=arguments;return new Promise((function(e,i){var o=n.apply(t,r);function u(n){nr(o,e,i,u,a,"next",n)}function a(n){nr(o,e,i,u,a,"throw",n)}u(void 0)}))}}function rr(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function er(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.push.apply(r,e)}return r}function ir(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(r,!0).forEach((function(t){rr(n,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):er(r).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))}))}return n}function or(n,t){return t[n]||n}var ur=["PUSH","GCM","APNS","APNS_SANDBOX","APNS_VOIP","APNS_VOIP_SANDBOX","ADM","SMS","VOICE","EMAIL","BAIDU","CUSTOM"].reduce((function(n,t){return n[t]=t,n}),{}),ar=Object.freeze({SESSION_START:"_session.start",SESSION_STOP:"_session.stop",SESSION_PAUSE:"_session.pause",SESSION_RESUME:"_session.resume",AUTH_SIGN_IN:"_userauth.sign_in",AUTH_SIGN_UP:"_userauth.sign_up",AUTH_FAIL:"_userauth.auth_fail",ECOM_PURCHASE:"_monetization.purchase",PAGE_VIEW:"pageView"}),cr=[429,500],sr=[202],fr=function(){if("undefined"==typeof window)return{};if(!window.navigator)return{};var n,t,r,e,i,o=window.navigator,u=o.platform,a=o.product,c=o.vendor,s=function(n){var t=/.+(Opera[\s[A-Z]*|OPR[\sA-Z]*)\/([0-9\.]+).*/i.exec(n);if(t)return{type:t[1],version:t[2]};var r=/.+(Trident|Edge)\/([0-9\.]+).*/i.exec(n);if(r)return{type:r[1],version:r[2]};var e=/.+(Chrome|Firefox|FxiOS)\/([0-9\.]+).*/i.exec(n);if(e)return{type:e[1],version:e[2]};var i=/.+(Safari)\/([0-9\.]+).*/i.exec(n);if(i)return{type:i[1],version:i[2]};var o=/.+(AppleWebKit)\/([0-9\.]+).*/i.exec(n);if(o)return{type:o[1],version:o[2]};var u=/.*([A-Z]+)\/([0-9\.]+).*/i.exec(n);return u?{type:u[1],version:u[2]}:{type:"",version:""}}(o.userAgent);return{platform:u,make:a||c,model:s.type,version:s.version,appVersion:[s.type,s.version].join("/"),language:(t=window.navigator,r=t.language,e=t.browserLanguage,i=t.languages,(r||e||(i||["en_US"])[0]).toLowerCase().replace("-","_")),timezone:(n=/\(([A-Za-z\s].*)\)/.exec((new Date).toString()),n&&n[1]||"")}}(),lr=[];function dr(){return{}}var hr=/.+\@.+\..+/;function vr(n){return hr.test(n)}function pr(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ir({getContext:n.getContext||dr,enrichEventAttributes:n.enrichEventAttributes||dr,enrichEventMetrics:n.enrichEventMetrics||dr,credentials:n.credentials||{},getEndpointId:n.getEndpointId},n),r=Sr(t),e=gr(ir({sentDataToPinpoint:r},t));Ar({},t.getContext(),n.getUserId);var i=mr(e);return{updateEndpoint:r,recordEvent:e,disable:function(){i()}}}function mr(n){if("undefined"==typeof window)return dr;var t=function(n){return function(){console.log("Fire stop session"),n("_session.stop",!1)}}(n);return window.addEventListener("beforeunload",t),function(){return window.removeEventListener("beforeunload",t)}}function wr(){if(void 0===window.sessionStorage)return null;var n=window.sessionStorage.getItem("__session_id");if(n)return n;var t=$t();return window.sessionStorage.setItem("__session_id",t),t}function yr(){try{return JSON.parse(localStorage.getItem("__endpoint"))||{}}catch(n){return{}}}function br(n){localStorage.setItem("__endpoint",JSON.stringify(n))}function gr(){var n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.sentDataToPinpoint,e=t.appPackageName,i=t.appTitle,o=t.appVersionCode,u=t.debug;return function(){var a=tr(regeneratorRuntime.mark((function a(c){var s,f,l,d,h,v,p,m,w,y,b,g,S,O,k,E,A,j,x,_,I,T=arguments;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=T.length>1&&void 0!==T[1]?T[1]:{},f=T.length>2&&void 0!==T[2]?T[2]:{},l=!(T.length>3&&void 0!==T[3])||T[3],d=or(c,t.eventMapping),"boolean"==typeof s&&(l=s,s={}),"boolean"==typeof f&&(l=f,f={}),h=t.getContext(),v=h.pageSession,p=h.subSessionId,m=h.subSessionStart,w=h.elapsed,!Object.entries(f).length&&"pageView"!==c){a.next=12;break}return a.next=11,Ar(f,h,t.getUserId);case 11:f=a.sent;case 12:return y=new Date,b=s.attributes||{},g={date:y.toISOString(),session:wr(),pageSession:v,hash:window.location.hash,path:window.location.pathname,referrer:document.referrer,search:window.location.search,title:document.title,host:window.location.hostname,url:window.location.origin+window.location.pathname},a.next=17,t.enrichEventAttributes();case 17:return S=ir({},g,{},a.sent,{},b),O=w+(y.getTime()-m),k=s.metrics||{},E={sessionTime:O,hour:y.getHours(),day:y.getDay()+1,month:y.getMonth()+1,year:y.getFullYear()},a.next=24,t.enrichEventMetrics();case 24:return A=ir({},E,{},a.sent,{},k),a.next=28,Nr(S);case 28:return a.t0=a.sent,a.next=31,Rr(A);case 31:a.t1=a.sent,j={attributes:a.t0,metrics:a.t1},x=$t(),_=(new Date).toISOString(),u&&(console.log("".concat(x,":").concat(d)),console.log("eventAttributes",j.attributes),console.log("eventMetrics",j.metrics)),I=rr({},x,{EventType:d,Timestamp:_,AppPackageName:e,AppTitle:i,AppVersionCode:o,Attributes:j.attributes,Metrics:j.metrics,Session:{Id:p,StartTimestamp:new Date(m).toISOString()}}),"_session.stop"===c&&(I[x].Session.Duration=Date.now()-m,I[x].Session.StopTimestamp=_),lr.push(I),a.next=41;break;case 41:if(l){a.next=43;break}return a.abrupt("return",r());case 43:n&&clearTimeout(n),n=setTimeout(r,3e3);case 45:case"end":return a.stop()}}),a)})));return function(n){return a.apply(this,arguments)}}()}function Sr(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.getEndpointId,r=n.debug;return function(){var e=tr(regeneratorRuntime.mark((function e(){var i,o,u,a,c,s,f,l,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>0&&void 0!==d[0]?d[0]:{},lr.length||Object.keys(i).length){e.next=4;break}return r&&console.log("No events, return early"),e.abrupt("return");case 4:return o=i,e.next=7,t();case 7:if(u=e.sent,r&&console.log("resolved endpointId",u),u){e.next=12;break}return console.error("No User ID found. Call Auth()"),e.abrupt("return");case 12:if(!Object.entries(i).length){e.next=19;break}return a=n.getContext(),e.next=16,Ar(i,a,n.getUserId);case 16:o=e.sent,e.next=20;break;case 19:o=yr()||{};case 20:return r&&console.log("endpointData",o),c=o.ChannelType,o.Address&&vr(o.Address)&&(c=ur.EMAIL),!c&&o.Address&&(c="android"===fr.platform?c||ur.GCM:c||ur.APNS),r&&console.log("CHANNEL_TYPE",c),s=lr.reduce((function(n,t){return ir({},t,{},n)}),{}),(f=o).RequestId=$t(),f.ChannelType=c,f.Address&&(f.OptOut=o.OptOut||"NONE"),l={BatchItem:rr({},u,{Endpoint:f,Events:s})},e.prev=31,e.next=34,Or(l,n);case 34:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(31),console.log("callPinPoint err",e.t0);case 40:return lr=[],e.abrupt("return",o);case 42:case"end":return e.stop()}}),e,null,[[31,37]])})));return function(){return e.apply(this,arguments)}}()}function Or(n,t){return kr.apply(this,arguments)}function kr(){return(kr=tr(regeneratorRuntime.mark((function n(t,r){var e,i,o,u,a,c,s,f,l,d,h,v,p,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=r.pinpointRegion,i=r.pinpointAppId,o=r.lambdaArn,u=r.lambdaRegion,a=r.getCredentials,c=r.debug,s=r.credentials,Object.keys(s).length||!a){n.next=12;break}return n.prev=3,n.next=6,a();case 6:s=n.sent,n.next=12;break;case 9:throw n.prev=9,n.t0=n.catch(3),new Error(n.t0);case 12:return f=new Yt.AwsClient({accessKeyId:s.accessKeyId||s.AccessKeyId,secretAccessKey:s.secretAccessKey||s.SecretKey,sessionToken:s.sessionToken||s.SessionToken,retries:5}),l=e||u,d=!0===r.fips?"-fips":"",h="https://lambda.".concat(u||e,".amazonaws.com/2015-03-31/functions/").concat(o,"/invocations"),v="https://pinpoint".concat(d,".").concat(l,".amazonaws.com/v1/apps/").concat(i,"/events"),p=o?h:v,n.next=21,f.fetch(p,{body:JSON.stringify(t)}).then((function(n){return n.json()}));case 21:return(m=n.sent)&&m.Results&&Object.keys(m.Results).map((function(n){return m.Results[n]})).forEach((function(n){var t=n.EndpointItemResponse||{},r=n.EventsItemResponse||{};Object.keys(t).length&&(c&&console.log("EndpointItemResponse",t),sr.includes(t.StatusCode)||cr.includes(t.StatusCode)||Er(t,Endpoint));var e=Object.keys(r);e.length&&(c&&console.log("EventsResponse",r),e.forEach((function(){})))})),n.abrupt("return",m);case 24:case"end":return n.stop()}}),n,null,[[3,9]])})))).apply(this,arguments)}function Er(n){var t=n.Message;if(400===n.StatusCode){if(t.startsWith("Missing ChannelType"))throw new Error("Missing ChannelType");if(t.startsWith("Exceeded maximum endpoint per user count"))throw new Error("Exceeded maximum endpoint per user count")}}function Ar(){return jr.apply(this,arguments)}function jr(){return(jr=tr(regeneratorRuntime.mark((function n(){var t,r,e,i,o,u,a,c,s,f,l=arguments;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1&&void 0!==l[1]?l[1]:{},e=l.length>2?l[2]:void 0,i=yr(),o=r.pageSession,u={Attributes:{},Demographic:ir({AppVersion:fr.appVersion||""},{AppVersion:fr.appVersion,Make:fr.make,Model:fr.model,ModelVersion:fr.version,Platform:fr.platform,Locale:fr.language},{},{}.demographic),Location:{},Metrics:{}},fr.device&&fr.device.vendor&&(u.Attributes.DeviceMake=[fr.device.vendor]),fr.device&&fr.device.model&&(u.Attributes.DeviceModel=[fr.device.model]),fr.device&&fr.device.type&&(u.Attributes.DeviceType=[fr.device.type]),fr.engine&&fr.engine.name&&(u.Demographic.Make=fr.engine.name),fr.browser&&fr.browser.name&&(u.Demographic.Model=fr.browser.name),fr.browser&&fr.browser.version&&(u.Demographic.ModelVersion=fr.browser.version),fr.os&&fr.os.name&&(u.Demographic.Platform=fr.os.name),fr.os&&fr.os.version&&(u.Demographic.PlatformVersion=fr.os.version),!(t=Jt.all([u,i,t],{arrayMerge:xr})).User||!t.User.UserId){n.next=22;break}return n.next=20,e();case 20:t.User.UserId!==(a=n.sent)&&(t.User.UserId=a);case 22:if(t.User&&t.User.UserId){n.next=27;break}return n.next=25,e();case 25:(c=n.sent)&&(t.User||(t.User={}),t.User.UserId=c);case 27:if(!t.User||!t.User.UserAttributes){n.next=31;break}return n.next=30,Nr(t.User.UserAttributes,!0);case 30:t.User.UserAttributes=n.sent;case 31:return n.next=33,Nr(t.Attributes,!0);case 33:return t.Attributes=n.sent,n.next=36,Rr(t.Metrics);case 36:return t.Metrics=n.sent,s="sessions",r.sessionKey&&(s=r.sessionKey()),f="pageViews",r.pageViewKey&&(f=r.pageViewKey()),t.Attributes.lastSession?(t.Attributes.lastSession[0]!==wr()&&(t.Attributes.lastSession=[wr()],t.Metrics[s]+=1),t.Attributes.lastPageSession[0]!==o&&(t.Attributes.lastPageSession=[o],t.Metrics[f]+=1)):(t.Attributes.lastSession=[wr()],t.Attributes.lastPageSession=[o],t.Metrics[s]=1,t.Metrics[f]=1),br(t),n.abrupt("return",t);case 44:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function xr(n,t){return t}function _r(n,t){return Ir.apply(this,arguments)}function Ir(){return(Ir=tr(regeneratorRuntime.mark((function n(t,r){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("function"!=typeof t){n.next=4;break}return n.next=3,t();case 3:t=n.sent;case 4:return n.abrupt("return",r(t));case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function Tr(n){return Array.isArray(n)?n.map((function(n){return n.toString()})):n.toString()}function Pr(n){return parseFloat(Number(Array.isArray(n)?n[0]:n))}function Nr(n){return Mr.apply(this,arguments)}function Mr(){return(Mr=tr(regeneratorRuntime.mark((function n(t){var r,e,i,o,u=arguments;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=u.length>1&&void 0!==u[1]&&u[1],e={},n.t0=regeneratorRuntime.keys(t);case 3:if((n.t1=n.t0()).done){n.next=17;break}if(i=n.t1.value,o=Array.isArray(t[i])?t[i]:[t[i]],!r){n.next=12;break}return n.next=9,_r(o,Tr);case 9:e[i]=n.sent,n.next=15;break;case 12:return n.next=14,_r(o[0],Tr);case 14:e[i]=n.sent;case 15:n.next=3;break;case 17:return n.abrupt("return",e);case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function Rr(n){return zr.apply(this,arguments)}function zr(){return(zr=tr(regeneratorRuntime.mark((function n(t){var r,e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r={},n.t0=regeneratorRuntime.keys(t);case 2:if((n.t1=n.t0()).done){n.next=9;break}return e=n.t1.value,n.next=6,_r(t[e],Pr);case 6:r[e]=n.sent,n.next=2;break;case 9:return n.abrupt("return",r);case 10:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var Cr={disableAnonymousTraffic:!1,pinpointRegion:"us-east-1",eventMapping:{}};function Dr(n){return Object.keys(n).reduce((function(t,r){var e=n[r];return"number"==typeof e&&(t.metrics[r]=e),"string"==typeof e&&(t.attributes[r]=e),t}),{attributes:{},metrics:{}})}const Lr=Object.freeze({__proto__:null,default:function(){var n,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.eventMapping||{},i=0,o=$t(),u=$t(),a=Date.now();return{name:"aws-pinpoint",config:ir({},Cr,{},r),bootstrap:function(n){var t=n.instance;n.config.disableAnonymousTraffic&&!t.user("userId")&&t.once("identifyStart",(function(n){n.plugins["aws-pinpoint"].loaded()||t.loadPlugin("aws-pinpoint")}))},initialize:function(r){var c=r.config,s=r.instance,f=c.disableAnonymousTraffic,l=s.getState(),d=l.context||{},h=d.app;if(!(l.user||{}).userId&&f)return!1;var v=pr(ir({},c,{appTitle:c.appTitle||h,appPackageName:c.appPackageName||h,appVersionCode:c.appVersionCode||d.version,getEndpointId:function(){return s.user("anonymousId")},getUserId:function(){return s.user("userId")},getContext:function(){return{elapsed:i,pageSession:o,subSessionId:u,subSessionStart:a,sessionKey:c.sessionKey,pageViewKey:c.pageViewKey}},enrichEventAttributes:function(){return{}},enrichEventMetrics:function(){return{}},eventMapping:e}));t=v.updateEndpoint,(n=v.recordEvent)("_session.start"),Qt((function(t){t?(i+=Date.now()-a,n("_session.stop",!1)):(u=$t(),a=Date.now(),n("_session.start"))}))},page:function(){n?n("pageView",!0).then((function(){o=$t()})):console.log("Pinpoint not loaded")},reset:function(){storage.removeItem("__endpoint")},track:function(t){var r=t.payload;if(n){if(!t.config.disableAnonymousTraffic||r.userId){var e=Dr(r.properties);n(r.event,e)}}else console.log("Pinpoint not loaded")},identify:function(n){var r=n.payload,e=r.userId,i=r.traits;if(t){var o={};e&&(o.UserId=e),i&&Object.keys(i).length&&(o.UserAttributes=i),t(ir({},i.email?{Address:i.email,ChannelType:ur.EMAIL}:{},{},Object.keys(o).length?{User:o}:{}))}else console.log("Pinpoint not loaded")},loaded:function(){return!!n}}},PINPOINT_EVENTS:ar}),Ur=o(Vt),Hr=o(Lr),Vr=u(e((function(n){n.exports=function(n,t){n="default"in n?n.default:n,t="default"in t?t.default:t;var r={storage:{},memory:!0,get:function(n){var t=void 0;try{t=window.localStorage&&window.localStorage.getItem(n)||this.storage[n]}catch(r){t=this.storage[n]}if(t)try{return JSON.parse(t)}catch(n){return}},set:function(n,t){t=JSON.stringify(t);try{window.localStorage.setItem(n,t)}catch(r){this.memory||(console.error("setting local storage failed, falling back to in-memory storage"),this.memory=!0),this.storage[n]=t}},delete:function(n){try{window.localStorage.removeItem(n)}catch(t){this.memory||(console.error("setting local storage failed, falling back to in-memory storage"),this.memory=!0),delete this.storage[n]}}},e="TELEMETRY_COGNITO_CREDENTIALS";function i(n){var t=n.telemetryData,r=n.dimensionLookup,e=void 0===r?{}:r,i=n.excludeKeys,a=void 0===i?[]:i;return Object.keys(t).filter((function(n){return!a.includes(n)})).map((function(n){return e[n]?{key:u(e,n),value:t[n]}:{key:n,value:o(t,n)}})).reduce((function(n,t){return n[t.key]=t.value,n}),{})}function o(n,t){return"json"===t?n[t]?JSON.stringify(n[t]):"null":void 0===n[t]?"null":n[t].toString()}function u(n,t){return"dimension"+n[t]}var c=["size","duration","position","number","count"];function s(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(n).filter((function(n){return t[n]||c.includes(n)})).map((function(r){return t[r]?{key:f(t,r),value:n[r]}:{key:r,value:n[r]}})).reduce((function(n,t){return n[t.key]=t.value,n}),{})}function f(n,t){return"metric"+n[t]}var l=function(n){return function(){var t=n.apply(this,arguments);return new Promise((function(n,r){return function e(i,o){try{var u=t[i](o),a=u.value}catch(n){return void r(n)}if(!u.done)return Promise.resolve(a).then((function(n){e("next",n)}),(function(n){e("throw",n)}));n(a)}("next")}))}},d=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")},h=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}(),v=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n},p=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t},m=function(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)};function w(n){var t=n.event,r=void 0===t?{}:t,e=n.dimensionLookup,o=void 0===e?{}:e,u=n.metricLookup,a=void 0===u?{}:u,c=r.eventType,f=void 0===c?"other":c,l=s(r,a),d=i({telemetryData:v({eventType:f},r),dimensionLookup:o,excludeKeys:["workflow"].concat(m(Object.keys(l)),m(Object.keys(a)))});return v({name:f,referrer:document.referrer,hostname:window.location.hostname,path:window.location.pathname},d,l)}var y=function(){function o(i){d(this,o);var u=i.app,a=void 0===u?{}:u,c=i.fips,s=i.userPoolID;this.analytics=n({app:a.name,plugins:[t({fips:c,pinpointAppId:a.id,getCredentials:function(){return function(n){var t="https://cognito-identity"+(!0===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).fips?"-fips":"")+".us-east-1.amazonaws.com/",i=r.get(e);if(i&&Date.now()/1e3<i.Expiration)return Promise.resolve(i);var o={method:"POST",headers:{"Content-type":"application/x-amz-json-1.1","X-Amz-Target":"AWSCognitoIdentityService.GetId"},body:JSON.stringify({IdentityPoolId:n})};return fetch(t,o).then((function(n){if(!n.ok)throw new Error(n.statusText);return n.json()})).then((function(n){var r={method:"POST",headers:{"Content-type":"application/x-amz-json-1.1","X-Amz-Target":"AWSCognitoIdentityService.GetCredentialsForIdentity"},body:JSON.stringify({IdentityId:n.IdentityId})};return fetch(t,r)})).then((function(n){if(!n.ok)throw new Error(n.statusText);return n.json()})).then((function(n){var t=n.Credentials;return r.set(e,t),t}))}(s,{fips:c})}})]}),this.name="amazon",v(this,i)}return h(o,[{key:"logPageView",value:function(n,t){var r=function(n){var t=n.page,r=n.previousPage,e=void 0===r?{}:r,o=n.options,u=void 0===o?{}:o,a=n.dimensionLookup,c=void 0===a?{}:a,f=n.metricLookup,l=void 0===f?{}:f,d=s(u,l),h=i({telemetryData:u,dimensionLookup:c,excludeKeys:["workflow"].concat(m(Object.keys(d)),m(Object.keys(l)))}),p=document||{},w=window&&window.location?window.location:{},y=w.pathname;return v({name:"pageView",referrer:p.referrer,hostname:w.hostname,path:t||y,pageUrl:t||y,pageName:p.title,previousPageUrl:e.pageUrl,previousPageName:e.pageName},h,d)}({page:n,previousPage:this.previousPage,options:t,dimensionLookup:this.dimensions,metricLookup:this.metrics});this.previousPage=r.attributes,this.analytics.track("pageView",r)}},{key:"logEvent",value:function(){var n=w({event:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},dimensionLookup:this.dimensions,metricLookup:this.metrics});this.analytics.track(n.name,n)}}]),o}();function b(n){var t=n.customTelemetryData,r=void 0===t?{}:t,e=n.dimensionLookup,i=void 0===e?{}:e,o=n.metricLookup,u=void 0===o?{}:o;return Object.keys(r).map((function(n){return i[n]?{key:g(i,n),value:r[n]}:u[n]?{key:S(u,n),value:r[n]}:void 0})).filter((function(n){return n})).reduce((function(n,t){return n[t.key]=t.value,n}),{})}function g(n,t){return"dimension"+n[t]}function S(n,t){return"metric"+n[t]}var O=function(){var n=l(regeneratorRuntime.mark((function n(t){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.resolve(""+t).then((function(){return p(a())}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),k="universal-analytics",E=function(){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,n),this.name="google",v(this,t)}return h(n,[{key:"logPageView",value:function(n,t){var r=function(n,t){var r={hitType:"pageview",page:n||window.location.pathname},e=b({customTelemetryData:t,dimensionLookup:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},metricLookup:arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}});return v({},r,e)}(n,t,this.dimensions,this.metrics);j((function(n){n.forEach((function(n){n.send(r)}))}))}},{key:"logEvent",value:function(n){var t=function(n){var t={hitType:"event",eventCategory:n.category||"none",eventAction:n.action,eventLabel:n.label},r=b({customTelemetryData:n,dimensionLookup:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},metricLookup:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}});return v({},t,r)}(n,this.dimensions,this.metrics);if(this.serverTracker)return this.serverTracker.event(t).send();j((function(n){n.forEach((function(n){n.send(t)}))}))}}],[{key:"load",value:function(){var t=l(regeneratorRuntime.mark((function t(r){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=void 0,"undefined"!=typeof window){t.next=12;break}return t.prev=2,t.next=5,O(k);case 5:e=t.sent,t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(2),new Error("Failed to import universal-analytics. "+t.t0.message);case 11:r.serverTracker=A(e.default,r.trackingId);case 12:return t.abrupt("return",new n(r));case 13:case"end":return t.stop()}}),t,this,[[2,8]])})));return function(n){return t.apply(this,arguments)}}()}]),n}();function A(n,t){if(void 0===t)throw new TypeError("Google Analytics Tracking ID not provided");return n(t)}function j(n){window.ga?window.ga((function(){n(window.ga.getAll())})):console.log(new Error("Google Analytics trackers not available"))}var x=function(n){var t={},r=t.lib={},e=function(){},i=r.Base={extend:function(n){e.prototype=this;var t=new e;return n&&t.mixIn(n),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=i.extend({init:function(n,t){n=this.words=n||[],this.sigBytes=null!=t?t:4*n.length},toString:function(n){return(n||a).stringify(this)},concat:function(n){var t=this.words,r=n.words,e=this.sigBytes;if(n=n.sigBytes,this.clamp(),e%4)for(var i=0;i<n;i++)t[e+i>>>2]|=(r[i>>>2]>>>24-i%4*8&255)<<24-(e+i)%4*8;else if(r.length>65535)for(i=0;i<n;i+=4)t[e+i>>>2]=r[i>>>2];else t.push.apply(t,r);return this.sigBytes+=n,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=n.ceil(r/4)},clone:function(){var n=i.clone.call(this);return n.words=this.words.slice(0),n},random:function(t){for(var r=[],e=0;e<t;e+=4)r.push(4294967296*n.random()|0);return new o.init(r,t)}}),u=t.enc={},a=u.Hex={stringify:function(n){var t=n.words;n=n.sigBytes;for(var r=[],e=0;e<n;e++){var i=t[e>>>2]>>>24-e%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(n){for(var t=n.length,r=[],e=0;e<t;e+=2)r[e>>>3]|=parseInt(n.substr(e,2),16)<<24-e%8*4;return new o.init(r,t/2)}},c=u.Latin1={stringify:function(n){var t=n.words;n=n.sigBytes;for(var r=[],e=0;e<n;e++)r.push(String.fromCharCode(t[e>>>2]>>>24-e%4*8&255));return r.join("")},parse:function(n){for(var t=n.length,r=[],e=0;e<t;e++)r[e>>>2]|=(255&n.charCodeAt(e))<<24-e%4*8;return new o.init(r,t)}},s=u.Utf8={stringify:function(n){try{return decodeURIComponent(escape(c.stringify(n)))}catch(n){throw Error("Malformed UTF-8 data")}},parse:function(n){return c.parse(unescape(encodeURIComponent(n)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=s.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(t){var r=this._data,e=r.words,i=r.sigBytes,u=this.blockSize,a=i/(4*u);if(a=t?n.ceil(a):n.max((0|a)-this._minBufferSize,0),i=n.min(4*(t=a*u),i),t){for(var c=0;c<t;c+=u)this._doProcessBlock(e,c);c=e.splice(0,t),r.sigBytes-=i}return new o.init(c,i)},clone:function(){var n=i.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0});r.Hasher=f.extend({cfg:i.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){return n&&this._append(n),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,r){return new n.init(r).finalize(t)}},_createHmacHelper:function(n){return function(t,r){return new l.HMAC.init(n,r).finalize(t)}}});var l=t.algo={};return t}(Math);(function(n){for(var t=x,r=(i=t.lib).WordArray,e=i.Hasher,i=t.algo,o=[],u=[],a=function(n){return 4294967296*(n-(0|n))|0},c=2,s=0;s<64;){var f;n:{for(var l=n.sqrt(f=c),d=2;d<=l;d++)if(!(f%d)){f=!1;break n}f=!0}f&&(s<8&&(o[s]=a(n.pow(c,.5))),u[s]=a(n.pow(c,1/3)),s++),c++}var h=[];i=i.SHA256=e.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(n,t){for(var r=this._hash.words,e=r[0],i=r[1],o=r[2],a=r[3],c=r[4],s=r[5],f=r[6],l=r[7],d=0;d<64;d++){if(d<16)h[d]=0|n[t+d];else{var v=h[d-15],p=h[d-2];h[d]=((v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3)+h[d-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+h[d-16]}v=l+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&s^~c&f)+u[d]+h[d],p=((e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&i^e&o^i&o),l=f,f=s,s=c,c=a+v|0,a=o,o=i,i=e,e=v+p|0}r[0]=r[0]+e|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+c|0,r[5]=r[5]+s|0,r[6]=r[6]+f|0,r[7]=r[7]+l|0},_doFinalize:function(){var t=this._data,r=t.words,e=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=n.floor(e/4294967296),r[15+(i+64>>>9<<4)]=e,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var n=e.clone.call(this);return n._hash=this._hash.clone(),n}}),t.SHA256=e._createHelper(i),t.HmacSHA256=e._createHmacHelper(i)})(Math),function(){var n=x.enc.Utf8;x.algo.HMAC=x.lib.Base.extend({init:function(t,r){t=this._hasher=new t.init,"string"==typeof r&&(r=n.parse(r));var e=t.blockSize,i=4*e;r.sigBytes>i&&(r=t.finalize(r)),r.clamp();for(var o=this._oKey=r.clone(),u=this._iKey=r.clone(),a=o.words,c=u.words,s=0;s<e;s++)a[s]^=1549556828,c[s]^=909522486;o.sigBytes=u.sigBytes=i,this.reset()},reset:function(){var n=this._hasher;n.reset(),n.update(this._iKey)},update:function(n){return this._hasher.update(n),this},finalize:function(n){var t=this._hasher;return n=t.finalize(n),t.reset(),t.finalize(this._oKey.clone().concat(n))}})}();var _=function(n){if(n)return x.SHA256(n).toString(x.enc.Hex)},I=["esri.com","esriuk.com","esri.de","esri.ca","esrifrance.fr","esri.nl","esri-portugal.pt","esribulgaria.com","esri.fi","esri.kr","esrimalaysia.com.my","esri.es","esriaustralia.com.au","esri-southafrica.com","esri.cl","esrichina.com.cn","esri.co","esriturkey.com.tr","geodata.no","esriitalia.it","esri.pl"];function T(){return"1"===("undefined"!=typeof navigator&&navigator.doNotTrack)||"undefined"!=typeof window&&"1"===window.doNotTrack}return function(){function n(t){d(this,n);try{this.trackers=[],this.workflows={},this.test=t.test,this.debug=t.debug,this.disabled=!function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.portal||{};return!(n.disabled||T()||void 0!==t.eueiEnabled&&!1===t.eueiEnabled||(!t.eueiEnabled||!t.user||t.user.orgId!==t.id)&&(!t.user||t.user.orgId||"US"!==t.ipCntryCode)&&(t.user||"US"!==t.ipCntryCode)&&Object.keys(t).length>0)}(t),this.disabled&&console.log("Telemetry Disabled"),t.portal&&t.portal.user?this.setUser(t.portal.user,(t.portal.subscriptionInfo||{}).type):t.user&&this.setUser(t.user),"undefined"==typeof window||this.disabled||this._initializeBrowserTrackers(t)}catch(n){console.error("Telemetry Disabled"),console.error(n),this.disabled=!0}}return h(n,[{key:"_initializeBrowserTrackers",value:function(n){if(n.amazon){var t=new y(n.amazon);this.trackers.push(t)}if(n.google){var r=new E(n.google);this.trackers.push(r)}this.trackers.length||console.error(new Error("No trackers configured"))}},{key:"setUser",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Public";this.user=n="string"==typeof n?{username:n}:n,this.user.accountType=t;var r=void 0;if(n.email&&n.email.split){var e=n.email.split("@")[1];r=I.filter((function(n){return e===n})).length>0}(r||["In House","Demo and Marketing"].indexOf(t)>-1)&&(this.user.internalUser=!0)}},{key:"logPageView",value:function(n){var t=this.preProcess(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(this.debug&&console.log("Tracking page view",JSON.stringify(t)),this.test&&!this.disabled)return t;var r=this.trackers.filter((function(n){return!n.disabled}));if(!r.length||this.disabled)return this.disabled||console.error(new Error("Page view was not logged because no trackers are configured.")),!1;var e=r.map((function(r){return r.logPageView(n,t)}));return Promise.all(e).then(),!0}},{key:"logEvent",value:function(){var n=this.preProcess(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});if(this.debug&&console.log("Tracking event",JSON.stringify(n)),this.test)return n;var t=this.trackers.filter((function(n){return!n.disabled}));if(!t.length||this.disabled)return this.disabled||console.error(new Error("Event was not logged because no trackers are configured.")),!1;var r=t.map((function(t){return t.logEvent(n)}));return Promise.all(r).then(),!0}},{key:"logError",value:function(){var n=v({eventType:"error"},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});this.logEvent(n)}},{key:"startWorkflow",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={name:n,start:Date.now(),steps:[],workflowId:Math.floor(17592186044416*(1+Math.random())).toString(16)};this._saveWorkflow(r);var e=v({name:n,step:"start"},t);return this._logWorkflow(e),r}},{key:"stepWorkflow",value:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e="string"==typeof options?r:r.details,i=v({name:n,step:t,details:e},r);this._logWorkflow(i)}},{key:"endWorkflow",value:function(n){var t=v({name:n,step:"finish"},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});this._logWorkflow(t)}},{key:"cancelWorkflow",value:function(n){var t=v({name:n,step:"cancel"},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});this._logWorkflow(t)}},{key:"getWorkflow",value:function(n){var t=r.get("TELEMETRY-WORKFLOW:"+n);if(t){if(Date.now()-t.start<18e5)return t;this._deleteWorkflow(t)}}},{key:"_saveWorkflow",value:function(n){r.set("TELEMETRY-WORKFLOW:"+n.name,n)}},{key:"_deleteWorkflow",value:function(n){r.delete("TELEMETRY-WORKFLOW:"+n.name)}},{key:"_logWorkflow",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n=this.preProcess(n);var t=this.getWorkflow(n.name);t||(this.startWorkflow(n.name),t=this.getWorkflow(n.name)),t.steps.push(n.step),t.duration=(Date.now()-t.start)/1e3,["cancel","finish"].indexOf(n.step)>-1?this._deleteWorkflow(t):this._saveWorkflow(t);var r=v(n,{eventType:"workflow",category:n.name,action:n.step,label:n.details,duration:t.duration,workflowId:t.workflowId});this.logEvent(r)}},{key:"preProcess",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return this.user&&(t={user:_(this.user.username),org:_(this.user.orgId),lastLogin:this.user.lastLogin,userSince:this.user.created,internalUser:this.user.internalUser||!1,accountType:this.user.accountType}),v({},n,t)}},{key:"disableTracker",value:function(n){var t=this.trackers.find((function(t){return t.name===n}));t&&(t.disabled=!0)}},{key:"enableTracker",value:function(n){var t=this.trackers.find((function(t){return t.name===n}));t&&(t.disabled=!1)}}],[{key:"load",value:(t=l(regeneratorRuntime.mark((function t(r){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=new n(r),"undefined"!=typeof window||!r.google){t.next=6;break}return t.next=4,E.load(r.google);case 4:e.trackers.push(t.sent);case 6:return t.abrupt("return",e);case 7:case"end":return t.stop()}}),t,this)}))),function(n){return t.apply(this,arguments)})}]),n;var t}()}(Ur,Hr)})));let Wr=class{constructor(t){n(this,t),this.google="UA-47337822-17"}initializeGoogleAnalytics(n){function t(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],t("js",new Date),t("config",n)}componentDidLoad(){this.initializeGoogleAnalytics(this.google),this.telemetry=new Vr({google:{dimensions:{datasetId:6,attribute:7,serviceQuery:8,searchQuery:9,objectId:10,facetValue:11}}}),this.telemetry.logEvent({category:"hub-component",action:"hub-telemetry:loaded",label:this.google})}handleEvent(n){this.telemetry.logEvent(n.detail)}render(){return t(r,null,t("slot",null))}};Wr.style=":host{display:block}";export{Wr as hub_telemetry}